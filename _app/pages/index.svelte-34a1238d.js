import{S as ie,i as ue,s as fe,e as p,c as v,a as g,d as h,b as u,g as W,k as C,t as x,m as q,h as R,L as le,J as c,M as F,j as X,N as ke,K as O,O as Ee,P as Se,Q as se,R as ae,T as Me,U as me,v as Ae,W as Pe,V as Ne,X as Ce,o as re,p as qe,q as ne,n as xe,w as _e,x as pe,y as ve,B as ge}from"../chunks/vendor-0c1d71b8.js";function be(n,e,l){const t=n.slice();return t[8]=e[l],t[10]=l,t}function we(n){let e,l=n[1],t=[];for(let s=0;s<l.length;s+=1)t[s]=ye(be(n,l,s));return{c(){e=p("div");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=v(s,"DIV",{class:!0});var r=g(e);for(let a=0;a<t.length;a+=1)t[a].l(r);r.forEach(h),this.h()},h(){u(e,"class","py-2 bg-white w-full rounded-b-md sm:w-1/2 overflow-y-scroll text-slate-900")},m(s,r){W(s,e,r);for(let a=0;a<t.length;a+=1)t[a].m(e,null)},p(s,r){if(r&10){l=s[1];let a;for(a=0;a<l.length;a+=1){const o=be(s,l,a);t[a]?t[a].p(o,r):(t[a]=ye(o),t[a].c(),t[a].m(e,null))}for(;a<t.length;a+=1)t[a].d(1);t.length=l.length}},d(s){s&&h(e),ke(t,s)}}}function ye(n){let e,l,t,s,r,a,o,f=n[8].title+"",i,d,_,y,b,w,m,k=n[8].year+"",N,T,S,j,D=n[8].rating+"",I,z,J,V,K,$;return{c(){e=p("div"),l=p("img"),r=C(),a=p("span"),o=p("span"),i=x(f),d=C(),_=p("br"),y=C(),b=p("span"),w=p("span"),m=x("Year: "),N=x(k),T=C(),S=p("span"),j=x("Rating: "),I=x(D),z=x("/10"),J=C(),this.h()},l(A){e=v(A,"DIV",{class:!0,"data-index":!0});var M=g(e);l=v(M,"IMG",{class:!0,src:!0,alt:!0}),r=q(M),a=v(M,"SPAN",{class:!0});var G=g(a);o=v(G,"SPAN",{class:!0});var U=g(o);i=R(U,f),d=q(U),_=v(U,"BR",{}),U.forEach(h),y=q(G),b=v(G,"SPAN",{class:!0});var L=g(b);w=v(L,"SPAN",{class:!0});var Q=g(w);m=R(Q,"Year: "),N=R(Q,k),Q.forEach(h),T=q(L),S=v(L,"SPAN",{class:!0});var Y=g(S);j=R(Y,"Rating: "),I=R(Y,D),z=R(Y,"/10"),Y.forEach(h),L.forEach(h),G.forEach(h),J=q(M),M.forEach(h),this.h()},h(){u(l,"class","h-24 mr-2 aspect-square object-cover rounded"),le(l.src,t=n[8].cover)||u(l,"src",t),u(l,"alt",s=""+(n[8].title+" Cover")),u(o,"class","font-extrabold text-lg"),u(w,"class","text-sm"),u(S,"class","text-sm"),u(b,"class","flex flex-col justify-self-end mt-1"),u(a,"class","flex flex-col h-full"),u(e,"class","flex align-center w-full p-2 h-25 bg-white hover:bg-gray-100 cursor-pointer"),u(e,"data-index",V=n[10])},m(A,M){W(A,e,M),c(e,l),c(e,r),c(e,a),c(a,o),c(o,i),c(o,d),c(o,_),c(a,y),c(a,b),c(b,w),c(w,m),c(w,N),c(b,T),c(b,S),c(S,j),c(S,I),c(S,z),c(e,J),K||($=F(e,"click",n[3]),K=!0)},p(A,M){M&2&&!le(l.src,t=A[8].cover)&&u(l,"src",t),M&2&&s!==(s=""+(A[8].title+" Cover"))&&u(l,"alt",s),M&2&&f!==(f=A[8].title+"")&&X(i,f),M&2&&k!==(k=A[8].year+"")&&X(N,k),M&2&&D!==(D=A[8].rating+"")&&X(I,D)},d(A){A&&h(e),K=!1,$()}}}function Re(n){let e,l,t,s,r,a,o=n[1].length>0&&n[0]&&we(n);return{c(){e=p("div"),l=p("input"),t=C(),o&&o.c(),this.h()},l(f){e=v(f,"DIV",{class:!0});var i=g(e);l=v(i,"INPUT",{autocomplete:!0,type:!0,class:!0}),t=q(i),o&&o.l(i),i.forEach(h),this.h()},h(){u(l,"autocomplete","off"),u(l,"type","text"),u(l,"class","outline outline-1 outline-slate-300 focus:outline-sky-600 focus:outline-2 p-2 drop-shadow-sm h-10 w-full sm:w-1/2 rounded bg-gradient-to-tr from-slate-100 to-white"),u(e,"class",s="transition-transform duration-500 w-full flex flex-col items-center translate-y-1/3 ease-out "+(n[1].length>0?"translate-y-0":"translate-y-1/3"))},m(f,i){W(f,e,i),c(e,l),c(e,t),o&&o.m(e,null),r||(a=[F(l,"input",n[2]),F(e,"focusin",n[5]),F(e,"blur",n[6])],r=!0)},p(f,[i]){f[1].length>0&&f[0]?o?o.p(f,i):(o=we(f),o.c(),o.m(e,null)):o&&(o.d(1),o=null),i&2&&s!==(s="transition-transform duration-500 w-full flex flex-col items-center translate-y-1/3 ease-out "+(f[1].length>0?"translate-y-0":"translate-y-1/3"))&&u(e,"class",s)},i:O,o:O,d(f){f&&h(e),o&&o.d(),r=!1,Ee(a)}}}function Te(n,e,l){let t,s=!1,{onMovieSelected:r}=e,a=new Array;function o(_){let y=_.currentTarget.value;if(y===""){l(1,a=[]);return}t&&clearTimeout(t),t=setTimeout(()=>{Se.get("https://yts.mx/api/v2/list_movies.json?query_term="+y+"&sort_by=seeds").then(b=>{let w=b.data.data.movies;l(1,a=w.map(m=>({title:m.title,cover:m.medium_cover_image,rating:m.rating,year:m.year,hashes:m.torrents.sort(({seedsA:k},{seedsB:N})=>N-k).map(({hash:k})=>k)})).sort((m,k)=>k.rating-m.rating))}).catch(console.log)},1e3)}function f(_){let y=a[_.currentTarget.dataset.index];r(y)}const i=()=>l(0,s=!0),d=()=>l(0,s=!1);return n.$$set=_=>{"onMovieSelected"in _&&l(4,r=_.onMovieSelected)},[s,a,o,f,r,i,d]}class je extends ie{constructor(e){super();ue(this,e,Te,Re,fe,{onMovieSelected:4})}}function Be(n){let e,l,t,s;return{c(){e=p("span"),l=C(),t=p("span"),s=p("span"),this.h()},l(r){e=v(r,"SPAN",{class:!0}),g(e).forEach(h),l=q(r),t=v(r,"SPAN",{class:!0});var a=g(t);s=v(a,"SPAN",{class:!0}),g(s).forEach(h),a.forEach(h),this.h()},h(){u(e,"class","absolute left-0 bottom-0 w-full h-1 bg-slate-200 rounded-b overflow-hidden"),u(s,"class","absolute left-0 bottom-0 h-1 w-full bg-gradient-to-tr from-green-400 to-green-600"),u(t,"class","absolute left-0 bottom-0 h-1 overflow-hidden")},m(r,a){W(r,e,a),W(r,l,a),W(r,t,a),c(t,s),n[5](t)},p:O,d(r){r&&h(e),r&&h(l),r&&h(t),n[5](null)}}}function Ie(n){let e;return{c(){e=p("span"),this.h()},l(l){e=v(l,"SPAN",{class:!0}),g(e).forEach(h),this.h()},h(){u(e,"class","bg-blue-500 left-0 bottom-0 absolute w-full h-1 animate-pulse")},m(l,t){W(l,e,t)},p:O,d(l){l&&h(e)}}}function Ve(n){let e,l,t,s,r,a,o,f,i,d,_,y,b,w=n[0].title+"",m,k,N,T,S,j,D,I=n[0].year+"",z,J,V,K,$=n[0].rating+"",A,M,G,U,L;function Q(P,E){return P[1]?Ie:Be}let Y=Q(n),B=Y(n);return{c(){e=p("div"),l=p("span"),t=se("svg"),s=se("symbol"),r=se("path"),a=se("use"),o=C(),f=p("img"),_=C(),y=p("span"),b=p("span"),m=x(w),k=C(),N=p("br"),T=C(),S=p("span"),j=p("span"),D=x("Year: "),z=x(I),J=C(),V=p("span"),K=x("Rating: "),A=x($),M=x("/10"),G=C(),B.c(),this.h()},l(P){e=v(P,"DIV",{class:!0});var E=g(e);l=v(E,"SPAN",{class:!0});var he=g(l);t=ae(he,"svg",{class:!0});var oe=g(t);s=ae(oe,"symbol",{id:!0,viewBox:!0});var de=g(s);r=ae(de,"path",{d:!0}),g(r).forEach(h),de.forEach(h),a=ae(oe,"use",{"xlink:href":!0}),g(a).forEach(h),oe.forEach(h),he.forEach(h),o=q(E),f=v(E,"IMG",{class:!0,src:!0,alt:!0}),_=q(E),y=v(E,"SPAN",{class:!0});var H=g(y);b=v(H,"SPAN",{class:!0});var Z=g(b);m=R(Z,w),k=q(Z),N=v(Z,"BR",{}),Z.forEach(h),T=q(H),S=v(H,"SPAN",{class:!0});var ee=g(S);j=v(ee,"SPAN",{class:!0});var ce=g(j);D=R(ce,"Year: "),z=R(ce,I),ce.forEach(h),J=q(ee),V=v(ee,"SPAN",{class:!0});var te=g(V);K=R(te,"Rating: "),A=R(te,$),M=R(te,"/10"),te.forEach(h),ee.forEach(h),H.forEach(h),G=q(E),B.l(E),E.forEach(h),this.h()},h(){u(r,"d","M20.281 20.656c0 0.391-0.156 0.781-0.438 1.062l-2.125 2.125c-0.281 0.281-0.672 0.438-1.062 0.438s-0.781-0.156-1.062-0.438l-4.594-4.594-4.594 4.594c-0.281 0.281-0.672 0.438-1.062 0.438s-0.781-0.156-1.062-0.438l-2.125-2.125c-0.281-0.281-0.438-0.672-0.438-1.062s0.156-0.781 0.438-1.062l4.594-4.594-4.594-4.594c-0.281-0.281-0.438-0.672-0.438-1.062s0.156-0.781 0.438-1.062l2.125-2.125c0.281-0.281 0.672-0.438 1.062-0.438s0.781 0.156 1.062 0.438l4.594 4.594 4.594-4.594c0.281-0.281 0.672-0.438 1.062-0.438s0.781 0.156 1.062 0.438l2.125 2.125c0.281 0.281 0.438 0.672 0.438 1.062s-0.156 0.781-0.438 1.062l-4.594 4.594 4.594 4.594c0.281 0.281 0.438 0.672 0.438 1.062z"),u(s,"id","icon-close"),u(s,"viewBox","0 0 22 28"),Me(a,"xlink:href","#icon-close"),u(t,"class","icon icon-close svelte-2qiq74"),u(l,"class","absolute top-0 right-2 text-slate-400 cursor-pointer"),u(f,"class","h-24 mr-2 aspect-square object-cover rounded"),le(f.src,i=n[0].cover)||u(f,"src",i),u(f,"alt",d=""+(n[0].title+" Cover")),u(b,"class","font-extrabold text-lg"),u(j,"class","text-sm"),u(V,"class","text-sm"),u(S,"class","flex flex-col justify-self-end mt-1"),u(y,"class","flex flex-col h-full"),u(e,"class","bg-gradient-to-tr from-slate-100 to-white flex align-center self-center p-2 w-full sm:w-1/2 outline outline-1 outline-slate-300 drop-shadow-sm relative pb-3 rounded")},m(P,E){W(P,e,E),c(e,l),c(l,t),c(t,s),c(s,r),c(t,a),c(e,o),c(e,f),c(e,_),c(e,y),c(y,b),c(b,m),c(b,k),c(b,N),c(y,T),c(y,S),c(S,j),c(j,D),c(j,z),c(S,J),c(S,V),c(V,K),c(V,A),c(V,M),c(e,G),B.m(e,null),U||(L=F(l,"click",n[3]),U=!0)},p(P,[E]){E&1&&!le(f.src,i=P[0].cover)&&u(f,"src",i),E&1&&d!==(d=""+(P[0].title+" Cover"))&&u(f,"alt",d),E&1&&w!==(w=P[0].title+"")&&X(m,w),E&1&&I!==(I=P[0].year+"")&&X(z,I),E&1&&$!==($=P[0].rating+"")&&X(A,$),Y===(Y=Q(P))&&B?B.p(P,E):(B.d(1),B=Y(P),B&&(B.c(),B.m(e,null)))},i:O,o:O,d(P){P&&h(e),B.d(),U=!1,L()}}}function We(n,e,l){let{currentMovie:t}=e,{onCancel:s}=e,r=!0,a,o;me.mitm="/watchit/mitm.html";function f(){window.onbeforeunload=null,s&&s(),o&&o()}Ae(()=>{let d=new Pe,_=new Array;t.hashes.forEach((y,b)=>{let w=d.add(y,{announce:["wss://tracker.openwebtorrent.com","wss://tracker.btorrent.xyz"]});_.push(w),w.on("ready",()=>{_.splice(b,1),_.forEach(m=>m.destroy()),w.files.forEach(m=>{if(m.name.endsWith(".mp4")||m.name.endsWith(".mkv")){let k=me.createWriteStream(m.name,{size:m.length}),N=k.getWriter();window.onunload=o=()=>{k.abort(),N.abort()},window.onbeforeunload=T=>{m.downloaded!==m.length&&(T.returnValue="Are you sure you want to cancel the download?")},m.createReadStream().on("data",T=>{N.write(T)}).on("end",()=>N.close());return}}),l(1,r=!1),w.on("download",()=>{let m=Math.round(w.progress*1e4)/100;l(2,a.style.width=`${m}%`,a)})})})});function i(d){Ne[d?"unshift":"push"](()=>{a=d,l(2,a)})}return n.$$set=d=>{"currentMovie"in d&&l(0,t=d.currentMovie),"onCancel"in d&&l(4,s=d.onCancel)},[t,r,a,f,s,i]}class De extends ie{constructor(e){super();ue(this,e,We,Ve,fe,{currentMovie:0,onCancel:4})}}function Ye(n){let e,l;return e=new je({props:{onMovieSelected:n[1]}}),{c(){_e(e.$$.fragment)},l(t){pe(e.$$.fragment,t)},m(t,s){ve(e,t,s),l=!0},p:O,i(t){l||(ne(e.$$.fragment,t),l=!0)},o(t){re(e.$$.fragment,t),l=!1},d(t){ge(e,t)}}}function ze(n){let e,l;return e=new De({props:{currentMovie:n[0],onCancel:n[2]}}),{c(){_e(e.$$.fragment)},l(t){pe(e.$$.fragment,t)},m(t,s){ve(e,t,s),l=!0},p(t,s){const r={};s&1&&(r.currentMovie=t[0]),s&1&&(r.onCancel=t[2]),e.$set(r)},i(t){l||(ne(e.$$.fragment,t),l=!0)},o(t){re(e.$$.fragment,t),l=!1},d(t){ge(e,t)}}}function $e(n){let e,l,t,s,r;const a=[ze,Ye],o=[];function f(i,d){return i[0]?0:1}return t=f(n),s=o[t]=a[t](n),{c(){e=C(),l=p("main"),s.c(),this.h()},l(i){Ce('[data-svelte="svelte-1bc0lsu"]',document.head).forEach(h),e=q(i),l=v(i,"MAIN",{class:!0});var _=g(l);s.l(_),_.forEach(h),this.h()},h(){document.title="watchit",u(l,"class","p-5 w-full h-full bg-slate-200 text-slate-900 flex justify-center")},m(i,d){W(i,e,d),W(i,l,d),o[t].m(l,null),r=!0},p(i,[d]){let _=t;t=f(i),t===_?o[t].p(i,d):(xe(),re(o[_],1,1,()=>{o[_]=null}),qe(),s=o[t],s?s.p(i,d):(s=o[t]=a[t](i),s.c()),ne(s,1),s.m(l,null))},i(i){r||(ne(s),r=!0)},o(i){re(s),r=!1},d(i){i&&h(e),i&&h(l),o[t].d()}}}function Ge(n,e,l){let t=null;function s(a){console.log("Movie Selected: ",a.title),l(0,t=a)}return[t,s,()=>l(0,t=null)]}class Je extends ie{constructor(e){super();ue(this,e,Ge,$e,fe,{})}}export{Je as default};
